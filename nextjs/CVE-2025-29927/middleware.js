import { NextResponse } from 'next/server'

export function middleware(request) {
    const authHeader = request.headers.get('Authorization')

    console.log('Middleware执行，Authorization头:', authHeader)

    if (!authHeader || !authHeader.startsWith('Bearer ')) {
        console.log('授权失败 - 无效的Authorization头')

        return NextResponse.redirect(new URL('/unauthorized', request.url))
    }



    console.log('授权成功，允许访问受保护资源')
    return NextResponse.next()
}

export const config = {
    matcher: ['/api/protected/:path*', '/protected/:path*'],
} 