# Jupyter Notebook XSS (CVE-2021-32798)

[中文版本(Chinese version)](README.zh-cn.md)

Jupyter Notebook (formerly known as IPython notebook) is an interactive notebook that supports running more than 40 programming languages.

It has an XSS vulnerability in versions less than 6.4.1 or 5.7.11, leading to remote code execution.

Vulnerability details:

 - https://github.com/google/security-research/security/advisories/GHSA-c469-p3jp-2vhx
 - https://nvd.nist.gov/vuln/detail/CVE-2021-32798

## Vulnerable Environment

Execute the following command to start a Jupyter Notebook 5.2.2:

```
docker compose up -d
```

After running, you will see the `poc` file after visiting `http://your-ip:8888?token=vulhub`.

## Vulnerability recurrence

Click directly on the `poc` file to see the XSS effect:

![](1.png)

The core reason for the vulnerability is that Jupyter Notebook uses the vulnerable Google Caja component. Certain versions of Google Caja are vulnerable to XSS attacks. XSS would allow an attacker to use Jupyter as an API to execute arbitrary code on the victim computer.