# Emlog data.php Background SQL Injection Vulnerability (CVE-2023-39121)

Emlog is an open-source blog system. This vulnerability exists in the data backup/restore functionality where improper input validation allows attackers to execute arbitrary SQL statements through specially crafted backup files.

Reference Links:

- <https://github.com/safe-b/CVE/issues/1#issue-1817133689>
- <https://www.emlog.net/docs/install/install_docker/>
- <https://hub.docker.com/layers/emlog/emlog/pro-latest-php7.4-apache/images/sha256-55bcc4861e1cc99ad79505be05ca3f3e5d9bb5dd16b8f2edc6ae62f7315cb8df>

## Vulnerability Environment

Execute the following command to start an Emlog 2.1.9 server:

```
docker compose up -d
```

After the environment starts, accessing `http://your-ip/install.php` will redirect to the installation page. Register a username and password, then complete the installation. After completion, log in to the admin management interface.

## Exploit Steps

1. Click: System → Data → Start Backup  
   ![Backup Start](https://github.com/vulhub/vulhub/emlog/CVE-2023-39121/1.png)

2. A SQL file will be downloaded  
   ![Downloaded SQL File](https://github.com/vulhub/vulhub/emlog/CVE-2023-39121/2.png)

3. Open the SQL file and add a malicious SQL statement (example: inserting a new user)

   ```sql
   INSERT INTO emlog_user VALUES('110','','$P$BnTaZnToynOoAVP6T/MiTsZc9ZAQNg.',(select user()),'writer','n','','123@qq.com','','','0','1687261845','1687261845');
   ```
   ![Modified SQL File](https://github.com/vulhub/vulhub/emlog/CVE-2023-39121/3.png)

4. Import the modified SQL file  
   ![SQL Import](https://github.com/vulhub/vulhub/emlog/CVE-2023-39121/4.png)

5. A new user appears, confirming successful SQL injection  
   ![New User Created](https://github.com/vulhub/vulhub/emlog/CVE-2023-39121/5.png)


